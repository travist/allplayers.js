/*! allplayers.js 2014-04-16 */
var NO_JQUERY={};!function(a,b,c){if(!("console"in a)){var d=a.console={};d.log=d.warn=d.error=d.debug=function(){}}b===NO_JQUERY&&(b={fn:{},extend:function(){for(var a=arguments[0],b=1,c=arguments.length;c>b;b++){var d=arguments[b];for(var e in d)a[e]=d[e]}return a}}),b.fn.pm=function(){return console.log("usage: \nto send:    $.pm(options)\nto receive: $.pm.bind(type, fn, [origin])"),this},b.pm=a.pm=function(a){e.send(a)},b.pm.bind=a.pm.bind=function(a,b,c,d,f){e.bind(a,b,c,d,f===!0)},b.pm.unbind=a.pm.unbind=function(a,b){e.unbind(a,b)},b.pm.origin=a.pm.origin=null,b.pm.poll=a.pm.poll=200;var e={send:function(a){var c=b.extend({},e.defaults,a),d=c.target;if(!c.target)return void console.warn("postmessage target window required");if(!c.type)return void console.warn("postmessage type required");var f={data:c.data,type:c.type};c.success&&(f.callback=e._callback(c.success)),c.error&&(f.errback=e._callback(c.error)),"postMessage"in d&&!c.hash?(e._bind(),d.postMessage(JSON.stringify(f),c.origin||"*")):(e.hash._bind(),e.hash.send(c,f))},bind:function(a,b,c,d,f){e._replyBind(a,b,c,d,f)},_replyBind:function(c,d,f,g,h){"postMessage"in a&&!g?e._bind():e.hash._bind();var i=e.data("listeners.postmessage");i||(i={},e.data("listeners.postmessage",i));var j=i[c];j||(j=[],i[c]=j),j.push({fn:d,callback:h,origin:f||b.pm.origin})},unbind:function(a,b){var c=e.data("listeners.postmessage");if(c)if(a)if(b){var d=c[a];if(d){for(var f=[],g=0,h=d.length;h>g;g++){var i=d[g];i.fn!==b&&f.push(i)}c[a]=f}}else delete c[a];else for(var g in c)delete c[g]},data:function(a,b){return b===c?e._data[a]:(e._data[a]=b,b)},_data:{},_CHARS:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),_random:function(){for(var a=[],b=0;32>b;b++)a[b]=e._CHARS[0|32*Math.random()];return a.join("")},_callback:function(a){var b=e.data("callbacks.postmessage");b||(b={},e.data("callbacks.postmessage",b));var c=e._random();return b[c]=a,c},_bind:function(){e.data("listening.postmessage")||(a.addEventListener?a.addEventListener("message",e._dispatch,!1):a.attachEvent&&a.attachEvent("onmessage",e._dispatch),e.data("listening.postmessage",1))},_dispatch:function(a){function b(b){c.callback&&e.send({target:a.source,data:b,type:c.callback})}try{var c=JSON.parse(a.data)}catch(d){return void console.warn("postmessage data invalid json: ",d)}if(!c.type)return void console.warn("postmessage message type required");var f=e.data("callbacks.postmessage")||{},g=f[c.type];if(g)g(c.data);else for(var h=e.data("listeners.postmessage")||{},i=h[c.type]||[],j=0,k=i.length;k>j;j++){var l=i[j];if(l.origin&&"*"!==l.origin&&a.origin!==l.origin){if(console.warn("postmessage message origin mismatch",a.origin,l.origin),c.errback){var m={message:"postmessage origin mismatch",origin:[a.origin,l.origin]};e.send({target:a.source,data:m,type:c.errback})}}else try{l.callback?l.fn(c.data,b,a):b(l.fn(c.data,a))}catch(d){if(!c.errback)throw d;e.send({target:a.source,data:d,type:c.errback})}}}};e.hash={send:function(b,c){var d=b.target,f=b.url;if(!f)return void console.warn("postmessage target window url is required");f=e.hash._url(f);var g,h=e.hash._url(a.location.href);if(a==d.parent)g="parent";else try{for(var i=0,j=parent.frames.length;j>i;i++){var k=parent.frames[i];if(k==a){g=i;break}}}catch(l){g=a.name}if(null==g)return void console.warn("postmessage windows must be direct parent/child windows and the child must be available through the parent window.frames list");var m={"x-requested-with":"postmessage",source:{name:g,url:h},postmessage:c},n="#x-postmessage-id="+e._random();d.location=f+n+encodeURIComponent(JSON.stringify(m))},_regex:/^\#x\-postmessage\-id\=(\w{32})/,_regex_len:"#x-postmessage-id=".length+32,_bind:function(){e.data("polling.postmessage")||(setInterval(function(){var b=""+a.location.hash,c=e.hash._regex.exec(b);if(c){var d=c[1];e.hash._last!==d&&(e.hash._last=d,e.hash._dispatch(b.substring(e.hash._regex_len)))}},b.pm.poll||200),e.data("polling.postmessage",1))},_dispatch:function(b){function c(a){f.callback&&e.send({target:i,data:a,type:f.callback,hash:!0,url:b.source.url})}if(b){try{if(b=JSON.parse(decodeURIComponent(b)),!("postmessage"===b["x-requested-with"]&&b.source&&null!=b.source.name&&b.source.url&&b.postmessage))return}catch(d){return}var f=b.postmessage,g=e.data("callbacks.postmessage")||{},h=g[f.type];if(h)h(f.data);else{var i;i="parent"===b.source.name?a.parent:a.frames[b.source.name];for(var j=e.data("listeners.postmessage")||{},k=j[f.type]||[],l=0,m=k.length;m>l;l++){var n=k[l];if(n.origin){var o=/https?\:\/\/[^\/]*/.exec(b.source.url)[0];if("*"!==n.origin&&o!==n.origin){if(console.warn("postmessage message origin mismatch",o,n.origin),f.errback){var p={message:"postmessage origin mismatch",origin:[o,n.origin]};e.send({target:i,data:p,type:f.errback,hash:!0,url:b.source.url})}continue}}try{n.callback?n.fn(f.data,c):c(n.fn(f.data))}catch(d){if(!f.errback)throw d;e.send({target:i,data:d,type:f.errback,hash:!0,url:b.source.url})}}}}},_url:function(a){return(""+a).replace(/#.*$/,"")}},b.extend(e,{defaults:{target:null,url:null,type:null,data:null,success:null,error:null,origin:"*",hash:!1}})}(this,"undefined"==typeof jQuery?NO_JQUERY:jQuery),"JSON"in window&&window.JSON||(JSON={}),function(){function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)d=rep[c],"string"==typeof d&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(a,b,c){c.SeamlessBase={getParam:function(b,c){c=c||a.location.search;var d="[?&]"+b+"=([^&#]*)",e=new RegExp(d),f=e.exec(c);return null===f?"":decodeURIComponent(f[1].replace(/\+/g," "))},isEmptyObject:function(a){var b;for(b in a)return!1;return!0}}}(window,document,jQuery),function(a,b,c){c.SeamlessConnection=function(a,b){this.id=0,this.target=a,this.url=b,this.active=!1,this.queue=[]},c.SeamlessConnection.prototype.send=function(a){this.active&&this.target?(a.hasOwnProperty("data")||(a={data:a}),a.target=this.target,a.url=this.url,a.type=a.type||"seamless_data",a.data=a.data||{},a.data.__id=this.id,c.pm(a)):this.queue.push(a)},c.SeamlessConnection.prototype.receive=function(a,b){"function"==typeof a&&(b=a,a="seamless_data");var d=this;c.pm.bind(a,function(a,c){return a.__id&&a.__id===d.id?b(a,c):!1})},c.SeamlessConnection.prototype.setActive=function(a){if(this.active=a,this.queue.length>0){for(var b in this.queue)this.send(this.queue[b]);this.queue=[],this.queue.length=0}}}(window,document,jQuery),function(a,b,c){return c.hasOwnProperty("pm")?void(c.seamless={options:{url:"",container:"body",update:200,allowStyleInjection:!1,onUpdate:null,onConnect:null},connect:function(d){d=d||{};for(var e in d)this.options.hasOwnProperty(e)&&(this.options[e]=d[e]);d=this.options;var f=new c.SeamlessConnection(a.parent,d.url);f.setActive(!0);var g=c.SeamlessBase.getParam("noiframe").toString();if("1"===g||"true"===g.toLowerCase())f.send({type:"seamless_noiframe",data:{href:a.location.href}});else{var h=!1,i=d.container,j=0,k=0,l=function(){k&&clearTimeout(k);var a=c(i).outerHeight(!0);if(a=a>100?a:100,!h&&j!==a){h=!0;var b={height:a};d.onUpdate&&d.onUpdate(b),f.send({type:"seamless_update",data:b,success:function(a){j=a.height,h=!1}})}k=setTimeout(l,d.update)};c("html").attr({style:"overflow:hidden;"+c("body").attr("html"),scroll:"no"});var m=function(){f.id||(f.send({type:"seamless_ready",data:{}}),setTimeout(m,200))},n=function(a){if(d.allowStyleInjection&&a.length>0){a="string"==typeof a?a:a.join(""),a=a.replace(/[<>]/g,"");var e=c("style#injected-styles");e.length>0?e.html(a):c("head").append(c(b.createElement("style")).attr({type:"text/css",id:"injected-styles"}).append(a))}};c.pm.bind("seamless_styles",function(a){n(a),l()}),c.pm.bind("seamless_connect",function(a){return f.id=a.id,d.onConnect&&d.onConnect(a),n(a.styles),l(),a}),m()}return f}}):void console.log("You must install the jQuery.pm module to use seamless.js.")}(window,document,jQuery),window.allplayers=window.allplayers||{},function(a,b,c){var d={};d.PADCHAR="=",d.ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZ",d.ALPHA+="abcdefghijklmnopqrstuvwxyz0123456789+/",d.makeDOMException=function(){try{return new DOMException(DOMException.INVALID_CHARACTER_ERR)}catch(a){var b=new Error("DOM Exception 5");return b.code=b.number=5,b.name=b.description="INVALID_CHARACTER_ERR",b.toString=function(){return"Error: "+b.name+": "+b.message},b}},d.getbyte64=function(a,b){var c=d.ALPHA.indexOf(a.charAt(b));if(-1===c)throw d.makeDOMException();return c},d.decode=function(a){a=""+a;var b,c,e,f=d.getbyte64,g=a.length;if(0===g)return a;if(g%4!==0)throw d.makeDOMException();b=0,a.charAt(g-1)===d.PADCHAR&&(b=1,a.charAt(g-2)===d.PADCHAR&&(b=2),g-=4);var h=[];for(c=0;g>c;c+=4)e=f(a,c)<<18|f(a,c+1)<<12|f(a,c+2)<<6|f(a,c+3),h.push(String.fromCharCode(e>>16,e>>8&255,255&e));switch(b){case 1:e=f(a,c)<<18,e|=f(a,c+1)<<12,e|=f(a,c+2)<<6,h.push(String.fromCharCode(e>>16,e>>8&255));break;case 2:e=f(a,c)<<18|f(a,c+1)<<12,h.push(String.fromCharCode(e>>16))}return h.join("")},d.getbyte=function(a,b){var c=a.charCodeAt(b);if(c>255)throw d.makeDOMException();return c},d.encode=function(a){if(1!==arguments.length)throw new SyntaxError("Not enough arguments");var b,c,e=d.PADCHAR,f=d.ALPHA,g=d.getbyte,h=[];a=""+a;var i=a.length-a.length%3;if(0===a.length)return a;for(b=0;i>b;b+=3)c=g(a,b)<<16,c|=g(a,b+1)<<8,c|=g(a,b+2),h.push(f.charAt(c>>18)),h.push(f.charAt(c>>12&63)),h.push(f.charAt(c>>6&63)),h.push(f.charAt(63&c));switch(a.length-i){case 1:c=g(a,b)<<16,h.push(f.charAt(c>>18)+f.charAt(c>>12&63)+e+e);break;case 2:c=g(a,b)<<16|g(a,b+1)<<8,h.push(f.charAt(c>>18)+f.charAt(c>>12&63)+f.charAt(c>>6&63)+e)}return h.join("")},c.base64=d}(window,document,window.allplayers),window.allplayers=window.allplayers||{},function(a,b,c){c.embed=function(a,b){if(b){a=a||{};for(var c in b)a.hasOwnProperty(c)||(a[c]=b[c]);this.options=a,this.init()}},c.embed.prototype.init=function(){}}(window,document,window.allplayers),window.allplayers=window.allplayers||{embed:{}},function(a,b,c,d){c.embed.server=function(a){c.embed.call(this,a,{getContainer:function(){return"body"},isComplete:function(){return!1}})},c.embed.server.prototype=new c.embed,c.embed.server.prototype.constructor=c.embed.server,c.embed.server.prototype.init=function(){c.embed.prototype.init.call(this);var a=this.options.getContainer();d.seamless.connect({url:c.base64.decode(d.SeamlessBase.getParam("ehost")),container:a,onUpdate:function(){d('a[href^="https://www."]',a).each(function(){var a=d(this).attr("href");d(this).attr({href:a.replace(/https:\/\/www.(.*?).allplayers.com/,"https://platform.$1.allplayers.com")})})}}),this.options.isComplete()&&d.seamless.send({type:"complete",data:{}}),d.pm.bind("chromeMsg",function(a){d.seamless.send({type:"chromeMsg",data:a})}),d.pm.bind("chromeMsgResp",function(a){d.seamless.send({type:"chromeMsgResp",data:a})})}}(window,document,window.allplayers,jQuery);